const notes = {
  "about-me": {
    folder: "Pinned",
    title: "About me",
    dateTime: "Today at 3:12 PM",
    metaTop: "Today at 3:12 PM",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "Swedish content writer & editor based in Lisbon.",
      "<br><br>",
      "Struggling to find the right words? I combine creative storytelling with SEO to help brands grow through compelling website copy, ad copy, guides, and other content that truly connects with your audience.",
      "<br><br>",
      '<div class="note-image-container"><img src="about-me-photo.jpg" alt="Jessika Hedman" class="note-image" /></div>',
    ].join(""),
  },
  "learning-in-public": {
    folder: "Thoughts",
    title: "Grocery list",
    dateTime: "3 December 2024 at 09:15",
    metaTop: "3 December 2024 at 09:15",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "<ul class=\"checklist\">",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Eggs</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Potatoes</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Garbage bags</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Greek yoghurt</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">1 red onion</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Bananas</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Strawberry jam</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Popcorn</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Fuet</span></li>",
      "  <li class=\"checklist-item checked\"><span class=\"check-bullet\"></span><span class=\"check-text\">Paprika</span></li>",
      "  <li class=\"checklist-item\"><span class=\"check-bullet\"></span><span class=\"check-text\">Red lentils</span></li>",
      "  <li class=\"checklist-item\"><span class=\"check-bullet\"></span><span class=\"check-text\">Zucchini</span></li>",
      "</ul>",
    ].join("\n"),
  },
  "ins-and-outs": {
    folder: "Thoughts",
    title: "Ins and Outs",
    dateTime: "31 December 2024 at 23:44",
    metaTop: "31 December 2024 at 23:44",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "<strong>In 2025</strong><br>",
      "Scarves<br>",
      "Bob (the hairstyle)<br>",
      "Religion / spirituality<br>",
      "Keeping your wisdom teeth<br>",
      "Being a couch potato<br>",
      "Pubic hair (still in)<br>",
      "Slow travel<br>",
      "<br>",
      "<strong>Out 2025</strong><br>",
      "Putting yourself first<br>",
      "Being a DJ<br>",
      "Crochet<br>",
      "Italy<br>",
      "Aging<br>",
      "Complicated diets",
    ].join(""),
  },
  "slow-productivity": {
    folder: "Thoughts",
    title: "Betrayal list",
    dateTime: "18 January 2025 at 16:47",
    metaTop: "18 January 2025 at 16:47",
    metaSecondary: "",
    body: [
      "H&M's fitting room",
      "My left wisdom tooth",
      "Oysters",
      "Any printer",
      "Me on Hinge",
      "Wet cobblestones",
      "Susan Miller",
      "My bangs when it's windy",
      "The clown sound my loafers make",
      "Depend eyebrow tint",
      "The way my tear duct betrays me when I'm angry",
      "Sunscreen SPF 30",
    ].join("\n"),
  },
  "books-to-read": {
    folder: "Thoughts",
    title: "Books people told me to read",
    dateTime: "22 March 2025 at 11:23",
    metaTop: "22 March 2025 at 11:23",
    metaSecondary: "",
    body: [
      "The Shadow of the Wind",
      "Fresh Water for Flowers",
      "Dead Women Don't Forgive",
      "Clean House",
      "The Year of Magical Thinking",
      "Never Be Alone Again",
      "The Sun Also Rises",
      "The Women I Think About at Night",
      "Body double",
    ].join("\n"),
  },
  "layers-of-the-twenties": {
    folder: "Thoughts",
    title: "Layers of the Twenties",
    dateTime: "23 July 2020 at 18:47",
    metaTop: "23 July 2020 at 18:47",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "I have been in love. Had my heart shattered. Felt the February sun warm me, wiped my tears in the dark.",
      "<br><br>",
      "I have danced with newfound friends on crowded dance floors. Sometimes felt lonely when the Sunday light seeped in.",
      "<br><br>",
      "I have held someone's hand, let someone hold me.",
      "<br>",
      "Big, sparkling waves have washed away my homesickness. But I still write letters to those I missed in my mind.",
      "<br><br>",
      "I have done right and wrong. And right again.",
      "<br>",
      "Searched for something new, longed for what I had.",
      "<br><br>",
      "Breathed in sunscreen on warm skin,<br>",
      "listened to my friends' laughter over a bottle of wine.",
      "<br><br>",
      "I have been afraid, and I have felt free.",
      "<br>",
      "Invincible.",
      "<br><br>",
      "Who am I?",
      "<br>",
      "I can be whoever I want.",
      "<br><br>",
      "I have dipped my head into the Atlantic, picked ripe fruit. My laundry has danced in the sun. I have searched for my mother's voice on the phone.",
      "<br><br>",
      "Spilled beer on wobbly tin tables, left my number with the guy at the bar. Whispered secrets to strangers, knowing I might never see them again.",
      "<br><br>",
      "Still confused but wide-awake, I felt it.",
      "<br>",
      "The layers of snow covering my chest<br>",
      "had slowly started to melt.",
    ].join(""),
  },
  "current-role": {
    folder: "Work experience",
    title: "What I do",
    dateTime: "8 September 2024 at 13:56",
    metaTop: "8 September 2024 at 13:56",
    metaSecondary: "",
    body: [
      "I create, optimize, and publish website content for startups and established companies across a wide range of industries, including crypto, iGaming, and sports.",
      "",
      "My work reflects a deep understanding of tone and voice while carefully balancing how readers experience content. Thoughtful research and analysis ensure every piece captivates readers and delivers results.",
    ].join("\n"),
  },
  "previous-projects": {
    folder: "Work experience",
    title: "Things and tools I am good with",
    dateTime: "5 October 2024 at 10:08",
    metaTop: "5 October 2024 at 10:08",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "<strong>Content & Copywriting</strong><br>",
      "Content creation<br>",
      "Content auditing & optimization<br>",
      "On-page SEO<br>",
      "Translation<br>",
      "<br>",
      "<strong>Web & Digital Platforms</strong><br>",
      "Web editing<br>",
      "WordPress<br>",
      "Basic HTML<br>",
      "Canva<br>",
      "Project management tools (e.g., JIRA)<br>",
      "<br>",
      "<strong>Marketing & Analytics</strong><br>",
      "Digital marketing<br>",
      "Content analytics & performance monitoring (Google Analytics, etc.)<br>",
      "Email marketing tools (Sendinblue, Mailchimp)",
    ].join(""),
  },
  passwords: {
    folder: "Thoughts",
    title: "Passwords",
    dateTime: "12 February 2025 at 20:14",
    metaTop: "12 February 2025 at 20:14",
    metaSecondary: "",
    body: "",
    locked: true,
  },
  "its-3am": {
    folder: "Thoughts",
    title: "It's 3 AM and I miss...",
    dateTime: "17 June 2025 at 03:22 AM",
    metaTop: "17 June 2025 at 03:22 AM",
    metaSecondary: "",
    body: "",
    locked: true,
  },
  "what-to-eat-lisbon": {
    folder: "Thoughts",
    title: "What to eat in Lisbon",
    dateTime: "4 april 2024 at 13.49 PM",
    metaTop: "4 april 2024 at 13.49 PM",
    metaSecondary: "",
    body: "",
    htmlBody: [
      "<strong>Lunch:</strong><br>",
      "Panda Cantina (pick the fried tofu, it's amazing)<br>",
      "O Sat√©lite (typical Portuguese food. Try a bitoque com molho or secretos de porco)<br>",
      "Java Rooftop (cute rooftop. Decent food, good drinks)<br>",
      "<br>",
      "<strong>Dinner:</strong><br>",
      "Lero Lero (Lisbon's best pizza. Get the Piccante!!! They also have a great selection of wines + a great atmosphere)<br>",
      "Da Noi (intimate, good food)<br>",
      "Rosamar (seafood, nice place, good drinks. I always order at least one espresso martini)<br>",
      "Bar Alimentar<br>",
      "Skizzo<br>",
      "Familjen<br>",
      "O Velho Eurico<br>",
      "Magnolia (wine + nice food). There are several good spots nearby to have a drink before or after.<br>",
      "<br>",
      "<strong>Wine:</strong><br>",
      "Tati Tati (also good food)<br>",
      "A Viagem das Horas<br>",
      "Vino Vero<br>",
      "Bom Bom Bom<br>",
      "NATA<br>",
      "Magnolia (try the baked Brie)<br>",
      "Black Sheep (take your glass to the park)<br>",
      "Senhor Uva (also good food)",
    ].join(""),
  },
};

function showNoteDetail(noteId) {
  const note = notes[noteId];
  if (!note) return;

  const listView = document.getElementById("list-view");
  const detailView = document.getElementById("detail-view");

  const titleEl = document.getElementById("detail-title");
  const metaTopEl = document.getElementById("detail-meta-top");
  const metaSecondaryEl = document.getElementById("detail-meta-secondary");
  const bodyEl = document.getElementById("detail-body");
  const folderTitleEl = document.getElementById("detail-folder-title");

  detailView.classList.toggle("is-locked-note", !!note.locked);

  titleEl.textContent = note.title;
  metaTopEl.textContent = note.metaTop;
  metaSecondaryEl.textContent = note.metaSecondary;

  if (note.locked) {
    bodyEl.innerHTML = [
      '<div class="locked-note-layout">',
      '  <div class="locked-note-icon"></div>',
      '  <div class="locked-note-text">This note is locked.</div>',
      '  <button class="locked-note-button" type="button">View Note</button>',
      "</div>",
    ].join("\n");
  } else if (note.htmlBody) {
    bodyEl.innerHTML = note.htmlBody;
  } else {
    bodyEl.textContent = note.body;
  }

  folderTitleEl.textContent = note.folder;

  listView.classList.add("hidden");
  detailView.classList.remove("hidden");
}

function showListView() {
  const listView = document.getElementById("list-view");
  const detailView = document.getElementById("detail-view");
  detailView.classList.add("hidden");
  listView.classList.remove("hidden");
}

function filterNotes(searchTerm) {
  const searchLower = searchTerm.toLowerCase().trim();
  const noteCards = document.querySelectorAll(".note-card");
  const sectionGroups = document.querySelectorAll(".section-group");

  if (!searchTerm.trim()) {
    // Show all notes and sections when search is empty
    noteCards.forEach((card) => {
      card.style.display = "";
    });
    sectionGroups.forEach((section) => {
      section.style.display = "";
    });
    return;
  }

  // Hide all sections initially
  sectionGroups.forEach((section) => {
    section.style.display = "none";
  });

  let hasMatches = false;

  noteCards.forEach((card) => {
    const noteId = card.getAttribute("data-note-id");
    const note = notes[noteId];
    if (!note) {
      card.style.display = "none";
      return;
    }

    // Search in title, meta, preview, and body
    const title = note.title.toLowerCase();
    const meta = note.metaSecondary?.toLowerCase() || "";
    const preview = card.querySelector(".note-preview")?.textContent.toLowerCase() || "";
    const body = note.body?.toLowerCase() || "";
    const folder = note.folder?.toLowerCase() || "";

    const matches =
      title.includes(searchLower) ||
      meta.includes(searchLower) ||
      preview.includes(searchLower) ||
      body.includes(searchLower) ||
      folder.includes(searchLower);

    if (matches) {
      card.style.display = "";
      // Show the parent section
      const section = card.closest(".section-group");
      if (section) {
        section.style.display = "";
        hasMatches = true;
      }
    } else {
      card.style.display = "none";
    }
  });
}

document.addEventListener("DOMContentLoaded", () => {
  // Populate note-meta elements with date/time
  document.querySelectorAll(".note-card").forEach((card) => {
    const id = card.getAttribute("data-note-id");
    if (!id) return;
    const note = notes[id];
    if (note && note.dateTime) {
      const metaEl = card.querySelector(".note-meta");
      if (metaEl) {
        metaEl.textContent = note.dateTime;
      }
    }
    card.style.cursor = "pointer";
    card.addEventListener("click", () => showNoteDetail(id));
  });

  const backButton = document.querySelector(".nav-back");
  if (backButton) {
    backButton.addEventListener("click", showListView);
  }

  // Menu toggle functionality
  document.querySelectorAll(".nav-menu-trigger").forEach((trigger) => {
    trigger.addEventListener("click", (event) => {
      event.stopPropagation();
      event.preventDefault();
      const menu = trigger.nextElementSibling;
      if (!menu || !menu.classList.contains("nav-menu-dropdown")) return;
      
      const isActive = menu.classList.contains("active");
      
      // Close all menus first
      document.querySelectorAll(".nav-menu-dropdown").forEach((dropdown) => {
        dropdown.classList.remove("active");
      });
      
      // Toggle the clicked menu
      if (!isActive) {
        menu.classList.add("active");
      }
    });
  });

  // Close menu when clicking on a menu item or outside
  document.querySelectorAll(".menu-item").forEach((item) => {
    item.addEventListener("click", () => {
      document.querySelectorAll(".nav-menu-dropdown").forEach((dropdown) => {
        dropdown.classList.remove("active");
      });
    });
  });

  document.addEventListener("click", (event) => {
    if (!event.target.closest(".nav-menu")) {
      document.querySelectorAll(".nav-menu-dropdown").forEach((dropdown) => {
        dropdown.classList.remove("active");
      });
    }
  });

  // Search functionality
  const searchInput = document.getElementById("search-input");
  if (searchInput) {
    searchInput.addEventListener("input", (event) => {
      filterNotes(event.target.value);
    });
  }
});


